components:
  terraform:
    # https://registry.terraform.io/modules/terraform-aws-modules/vpc/aws/latest
    # https://github.com/terraform-aws-modules/terraform-aws-vpc
    vpc/test-eks:
      metadata:
        component: vpc
      vars:
        name: test-eks
        azs:
          - ap-southeast-1a
          - ap-southeast-1b
          - ap-southeast-1c
        enable_nat_gateway: true
        single_nat_gateway: true
        one_nat_gateway_per_az: false
        enable_dns_hostnames: true
        enable_dns_support: true
        # https://docs.aws.amazon.com/eks/latest/userguide/network_reqs.html
        # https://developer.hashicorp.com/terraform/language/functions/cidrsubnet
        # https://www.solarwinds.com/free-tools/advanced-subnet-calculator
        # 64 subnets, 1022 hosts per subnet /22
        cidr: 10.10.0.0/16
        public_subnets:
          - 10.10.0.0/22
          - 10.10.4.0/22
          - 10.10.8.0/22
        public_subnet_tags:
          kubernetes.io/role/elb: 1
        private_subnets:
          - 10.10.12.0/22
          - 10.10.16.0/22
          - 10.10.20.0/22
        private_subnet_tags:
          kubernetes.io/role/internal-elb: 1
